<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>QUEST</title>

<!-- Fonte medieval -->
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#020617;
  --panel:#0b1220;
  --panel-2:#0f172a;
  --border:rgba(255,215,160,.25);
  --text:#e5e7eb;
  --muted:#94a3b8;
  --gold:#facc15;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:Inter,system-ui,sans-serif;
  background:radial-gradient(circle at top,#020617,#000);
  color:var(--text);
}

/* ===== HEADER ===== */
header{
  padding:24px 32px;
  border-bottom:1px solid rgba(255,255,255,.08);
}

.brand{
  display:flex;
  align-items:center;
  gap:12px;
}

.brand span{
  font-size:28px;
  filter:drop-shadow(0 0 6px rgba(255,215,160,.4));
}

.brand h1{
  font-family:Cinzel,serif;
  font-size:28px;
  letter-spacing:2px;
  margin:0;
}

.subtitle{
  margin-top:6px;
  font-size:14px;
  opacity:.75;
}

/* ===== LAYOUT ===== */
main{
  max-width:1300px;
  margin:auto;
  padding:24px;
  display:grid;
  grid-template-columns:1fr;
  gap:24px;
}

@media(min-width:1100px){
  main{
    grid-template-columns:1.1fr .9fr;
  }
}

.card{
  background:var(--panel);
  border:1px solid var(--border);
  box-shadow:0 0 40px rgba(0,0,0,.6);
  padding:20px;
}

/* ===== ABOUT ===== */
.about p{
  line-height:1.6;
  color:var(--muted);
}

/* ===== PROFILE ===== */
.profile-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:14px;
  margin-top:12px;
}

.stat{
  background:var(--panel-2);
  padding:12px;
  border-radius:6px;
  font-size:13px;
}

.stat b{
  display:block;
  font-size:16px;
  color:#fff;
}

/* ===== SELECTS ===== */
select{
  background:var(--panel-2);
  color:var(--text);
  border:1px solid rgba(255,255,255,.15);
  padding:6px 10px;
  border-radius:6px;
  outline:none;
}

select option{
  background:#020617;
}

/* ===== ACHIEVEMENTS ===== */
.achievements{
  display:grid;
  gap:10px;
  margin-top:12px;
}

.achievement{
  display:flex;
  justify-content:space-between;
  gap:12px;
  background:var(--panel-2);
  padding:12px;
  border-radius:6px;
  opacity:.4;
}

.achievement.unlocked{
  opacity:1;
  border:1px solid rgba(250,204,21,.3);
}

.achievement h4{
  margin:0 0 4px 0;
}

.badge{
  color:var(--gold);
}

/* ===== BOOKS ===== */
.books{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:14px;
  margin-top:12px;
}

.book{
  background:var(--panel-2);
  padding:12px;
  border-radius:6px;
  cursor:pointer;
  transition:.2s;
}

.book:hover{
  transform:translateY(-2px);
}

.progress{
  height:6px;
  background:#020617;
  border-radius:4px;
  overflow:hidden;
  margin-top:8px;
}

.progress div{
  height:100%;
  background:linear-gradient(90deg,#38bdf8,#22c55e);
}

/* ===== MODAL ===== */
.modal{
  position:fixed;
  inset:0;
  display:none;
  z-index:100;
}

.modal.show{
  display:block;
}

.modal-backdrop{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.75);
}

.modal-panel{
  position:relative;
  max-width:720px;
  margin:8vh auto;
  background:var(--panel);
  border:2px solid var(--border);
  box-shadow:0 0 50px rgba(0,0,0,.8);
  padding:24px;
}

.close{
  position:absolute;
  top:12px;
  right:12px;
  background:none;
  border:none;
  color:#fff;
  font-size:18px;
  cursor:pointer;
}

/* ===== FOOTER ===== */
footer{
  text-align:center;
  font-size:12px;
  opacity:.5;
  padding:24px;
}
</style>
</head>

<body>

<header>
  <div class="brand">
    <span>ðŸ“œ</span>
    <h1>QUEST</h1>
  </div>
  <div class="subtitle">Vitrine medieval do seu progresso e conquistas</div>
</header>

<main>

<!-- SOBRE -->
<section class="card about">
  <h2>ðŸ“– O que Ã© o QUEST?</h2>
  <p>
    QUEST Ã© um RPG de leitura e estudo onde cada livro Ã© uma jornada.
    VocÃª registra livros, capÃ­tulos e tÃ³picos, acompanha seu progresso,
    finaliza obras e desbloqueia medalhas e conquistas.
  </p>
  <p>
    Esta vitrine existe para exibir sua coleÃ§Ã£o, progresso e conquistas
    de forma visual, elegante e permanente.
  </p>
</section>

<!-- PERFIL -->
<section class="card">
  <h2>ðŸ›¡ï¸ Perfil do Jogador</h2>
  <div id="profile" class="profile-grid"></div>
</section>

<!-- CONQUISTAS -->
<section class="card">
  <h2>ðŸ† Conquistas</h2>
  <select id="achievementFilter">
    <option value="all">Todas</option>
    <option value="unlocked">Destravadas</option>
    <option value="locked">Bloqueadas</option>
  </select>
  <div id="achievements" class="achievements"></div>
</section>

<!-- LIVROS -->
<section class="card">
  <h2>ðŸ“š ColeÃ§Ã£o</h2>
  <select id="bookFilter">
    <option value="all">Todos</option>
    <option value="progress">Em progresso</option>
    <option value="done">Finalizados</option>
  </select>
  <div id="books" class="books"></div>
</section>

</main>

<!-- MODAL -->
<div id="modal" class="modal">
  <div class="modal-backdrop"></div>
  <div class="modal-panel">
    <button class="close" onclick="closeModal()">âœ–</button>
    <div id="modalContent"></div>
  </div>
</div>

<footer>
  Feito com QUEST â€¢ Vitrine
</footer>

<script>
/* ===== CATÃLOGO FIXO DE CONQUISTAS ===== */
const ACHIEVEMENTS_CATALOG = [
  {id:'first_book',name:'Primeiro Livro',desc:'Finalize 1 livro',medals:2},
  {id:'ten_books',name:'Leitor Dedicado',desc:'Finalize 10 livros',medals:5},
  {id:'topics_100',name:'Mestre dos TÃ³picos',desc:'Conclua 100 tÃ³picos',medals:3}
];

let DATA=null, MERGED_ACHIEVEMENTS=[];

fetch('./public.json',{cache:'no-store'})
  .then(r=>r.json())
  .then(json=>{
    DATA=json;
    mergeAchievements();
    renderProfile();
    renderAchievements();
    renderBooks();
  })
  .catch(()=>{
    document.body.innerHTML='<h2 style="padding:40px">public.json nÃ£o encontrado</h2>';
  });

function mergeAchievements(){
  const unlocked=DATA.achievements||[];
  const map={};
  unlocked.forEach(a=>map[a.id]=a);
  MERGED_ACHIEVEMENTS=ACHIEVEMENTS_CATALOG.map(a=>({
    ...a,
    unlocked:!!map[a.id],
    date:map[a.id]?.date||null
  }));
}

/* ===== RENDER ===== */
function renderProfile(){
  const p=document.getElementById('profile');
  p.innerHTML=`
    <div class="stat"><b>${DATA.player?.name||'Jogador'}</b>Nome</div>
    <div class="stat"><b>${DATA.stats?.booksTotal||0}</b>Livros</div>
    <div class="stat"><b>${DATA.stats?.booksFinished||0}</b>Finalizados</div>
    <div class="stat"><b>${DATA.stats?.medals||0}</b>Medalhas</div>
    <div class="stat"><b>${DATA.stats?.streak||0}d</b>Streak</div>
    <div class="stat"><b>${DATA.stats?.time||'0m'}</b>Tempo</div>
  `;
}

function renderAchievements(){
  const f=document.getElementById('achievementFilter').value;
  const c=document.getElementById('achievements');
  c.innerHTML='';
  MERGED_ACHIEVEMENTS
    .filter(a=>f==='all'||(f==='unlocked'&&a.unlocked)||(f==='locked'&&!a.unlocked))
    .forEach(a=>{
      c.innerHTML+=`
        <div class="achievement ${a.unlocked?'unlocked':''}">
          <div>
            <h4>${a.name}</h4>
            <div>${a.desc}</div>
          </div>
          <div class="badge">ðŸ… ${a.medals}</div>
        </div>
      `;
    });
}

document.getElementById('achievementFilter').onchange=renderAchievements;

function renderBooks(){
  const f=document.getElementById('bookFilter').value;
  const c=document.getElementById('books');
  c.innerHTML='';
  (DATA.books||[])
    .filter(b=>f==='all'||(f==='progress'&&!b.finished)||(f==='done'&&b.finished))
    .forEach(b=>{
      c.innerHTML+=`
        <div class="book" onclick='openBook(${JSON.stringify(b)})'>
          <b>${b.title}</b><br>
          <small>${b.author||''}</small>
          <div class="progress"><div style="width:${b.progress||0}%"></div></div>
        </div>
      `;
    });
}

function openBook(b){
  document.getElementById('modalContent').innerHTML=`
    <h2>${b.title}</h2>
    <p>${b.author||''}</p>
    <p>Progresso: ${b.progress||0}%</p>
  `;
  document.getElementById('modal').classList.add('show');
}

function closeModal(){
  document.getElementById('modal').classList.remove('show');
}
</script>

</body>
</html>
